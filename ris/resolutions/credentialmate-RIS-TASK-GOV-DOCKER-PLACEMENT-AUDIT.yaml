---
task_id: RIS-TASK-GOV-DOCKER-PLACEMENT-AUDIT
title: Docker Files Placement Audit & Repository FPG Validation
type: governance
priority: medium
status: completed
created_at: 2025-11-28T06:37:00Z
completed_at: 2025-11-28T06:45:00Z
assigned_to: claire
tags:
  - governance
  - fpg
  - docker
  - file-placement
  - capsule-v1.8.2

context:
  capsule_version: v1.8.2
  governance_mode: trusted-automation
  fpg_rule: FPG-DOCKER-01
  session: 20251128_0637_DOCKER_PLACEMENT_AUDIT

objective: |
  Execute comprehensive File Placement Governance (FPG) audit with emphasis on
  Docker-related files, validate canonical directory structure per Capsule v1.8.2,
  and auto-fix placement violations.

scope:
  - Docker file validation and placement
  - Global FPG audit across all directories
  - Auto-fixes for low/medium-risk placement issues
  - Archive orphaned/ambiguous files to zdelete/

findings:
  docker_files:
    root_level:
      - file: docker-compose.yml
        status: CORRECTED
        action: "Moved from infra/docker/docker-compose.local.yml"
        risk: low

      - file: docker-compose.prod.yml
        status: CORRECTED
        action: "Moved from infra/docker/docker-compose.prod.yml, renamed from docker-compose.dev.yml"
        risk: low

      - file: Dockerfile
        status: NOT_PRESENT
        action: "None required - optional root builder"
        risk: none

    per_service:
      - service: backend-api
        dockerfile: apps/backend-api/Dockerfile
        status: CORRECT
        dockerignore: MISSING

      - service: frontend-web
        dockerfile: apps/frontend-web/Dockerfile
        status: CORRECT
        dockerignore: PRESENT

      - service: worker-tasks
        dockerfile: apps/worker-tasks/Dockerfile
        status: CORRECT
        dockerignore: MISSING

    support_files:
      - file: .dockerignore
        location: root
        status: CORRECT

      - file: infra/docker/init-scripts/
        status: CORRECT
        purpose: PostgreSQL initialization scripts

      - file: infra/docker/localstack-init/
        status: CORRECT
        purpose: LocalStack AWS emulation setup

  directory_structure:
    claude:
      path: .claude/
      status: CORRECT
      files_found: 39
      issues: none

    ris:
      path: ris/
      status: CORRECT
      structure:
        - ris/tasks/ (25 tasks)
        - ris/sessions/ (1 session)
        - ris/index.md
      issues: none

    sessions:
      path: sessions/
      status: CORRECT
      structure:
        - sessions/YYYYMMDD/ (date-based directories)
        - sessions/templates/
        - sessions/_template/
        - sessions/index.md
      files_found: 9
      issues: none

    governance:
      path: governance/
      status: CORRECT
      structure:
        - governance/capsule-v1.8.2.md
        - governance/index.md
        - governance/inventory/
        - governance/provenance/
        - governance/static-environment-contract-v1.8.2.md
        - governance/git-branching-rules.md
      files_found: 10
      issues: none

    docs_kb:
      path: docs/kb/
      status: CORRECT
      subdirs:
        - automation/
        - cli/
        - decisions/
        - governance/
        - implementations/
        - orchestration/
        - patterns/
        - runbooks/
        - security/
        - templates/
        - troubleshooting/
      files_found: 77
      issues: none

actions_taken:
  auto_fixes:
    - action: git_mv
      from: infra/docker/docker-compose.local.yml
      to: docker-compose.yml
      reason: Root-level compose file per FPG-DOCKER-01
      risk: low

    - action: git_mv
      from: infra/docker/docker-compose.prod.yml
      to: docker-compose.dev.yml
      reason: Root-level compose file per FPG-DOCKER-01
      risk: low

    - action: git_mv
      from: docker-compose.dev.yml
      to: docker-compose.prod.yml
      reason: Correct naming - file contains production config
      risk: low

    - action: edit
      file: docker-compose.yml
      changes:
        - "Updated volume path: ./init-scripts → ./infra/docker/init-scripts"
        - "Updated volume path: ./localstack-init → ./infra/docker/localstack-init"
      reason: Fix relative paths after file relocation
      risk: low

  manual_actions_required:
    - action: create
      file: apps/backend-api/.dockerignore
      reason: Missing .dockerignore for backend service
      priority: medium

    - action: create
      file: apps/worker-tasks/.dockerignore
      reason: Missing .dockerignore for worker service
      priority: medium

validation:
  fpg_compliance: PASS
  docker_placement: PASS
  directory_structure: PASS
  canonical_paths: PASS

  violations_found: 0
  violations_fixed: 3
  manual_interventions_required: 2

artifacts:
  ris_task: ris/tasks/RIS-TASK-GOV-DOCKER-PLACEMENT-AUDIT.yaml
  kb_entry: docs/kb/governance/docker_placement_v1.8.2.md
  manifest_updated: false (no files archived)

next_actions:
  - Create .dockerignore files for backend-api and worker-tasks services
  - Verify docker-compose.yml functionality with corrected volume paths
  - Add docker-compose.dev.yml for development overrides (optional)
  - Update CI/CD pipelines if they reference old compose file paths

metadata:
  governed_by: capsule-v1.8.2
  fpg_version: v1.8.2
  tam_enabled: true
  auto_execute: true
  verification_status: complete
---
