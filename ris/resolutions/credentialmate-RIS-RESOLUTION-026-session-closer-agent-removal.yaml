---
id: RIS-RESOLUTION-026
title: Session-Closer Agent Removal - Bash Execution Limitation
type: resolution
status: implemented
created: 2025-12-01T05:00:00Z
resolved: 2025-12-01T05:15:00Z
priority: high
risk_level: low
capsule_version: v10.0

problem:
  summary: |
    session-closer agent couldn't execute bash commands when delegated via Task
    tool, resulting in simulated output instead of actual file creation.

  impact:
    - /close command created no files automatically
    - Agent only simulated bash commands in response text
    - Session files had to be manually created
    - Unnecessary complexity for simple task

  root_cause: |
    Agents invoked via Task tool cannot execute bash commands - they can only
    simulate them in response text. This is a fundamental limitation of the
    Task tool delegation model.

    The session-closer agent had tools: read,write,edit,bash,glob,grep in its
    frontmatter, but when invoked via Task tool, bash execution was unavailable.

solution:
  approach: |
    Removed session-closer agent entirely and handle /close directly in main
    Claude Code context.

    **Why this works:**
    - Main Claude Code context CAN execute bash commands
    - Session closure is simple (create file, move to archive, commit)
    - No delegation overhead needed
    - Cleaner, more reliable

  implementation:
    1. Deleted .claude/agents/session-closer.md
    2. Updated .claude/commands/close.md
       - Added note: runs directly in main context (no agent)
       - Documented why agents can't work for session closure
    3. Updated CLAUDE.md
       - Agent count: 14 → 13
       - Changed "Close session" to "/close command (no agent)"
       - Removed session-closer from inventory table
    4. Created FIX-session-closer-agent-removed.md documenting the issue

  verification:
    - session-closer.md deleted: ✅
    - Agent count now 13: ✅
    - /close command updated: ✅
    - CLAUDE.md updated: ✅

decisions:
  - Don't delegate simple tasks requiring bash execution to agents
  - Handle session closure in main Claude Code context
  - Agents best for: complex workflows, specialized knowledge, parallel READ ops
  - Session closure doesn't meet any agent use case criteria

files_changed:
  - .claude/agents/session-closer.md (deleted)
  - .claude/commands/close.md (updated)
  - CLAUDE.md (updated - agent count 14→13)
  - sessions/archive/20251201/FIX-session-closer-agent-removed.md (created)

keywords:
  - agent-limitations
  - bash-execution
  - task-delegation
  - session-management
  - architecture-simplification

lessons_learned:
  - Delegated agents cannot execute bash commands (Task tool limitation)
  - Main context has more capabilities than delegated agents
  - Keep simple tasks in main context
  - Don't over-engineer with agents for straightforward operations
  - Test agent capabilities before implementing complex delegation

anti_patterns:
  - Delegating bash-heavy tasks to agents
  - Creating agents for simple operations
  - Assuming agent frontmatter tools work in delegated context

proven_solutions:
  - Handle bash execution in main Claude Code context
  - Reserve agents for specialized, complex, or parallel-safe operations
  - Verify agent tool availability in delegation context

references:
  - sessions/archive/20251201/FIX-session-closer-agent-removed.md
  - .claude/commands/close.md
  - .claude/agents/ (session-closer.md removed)

related:
  - RIS-RESOLUTION-025 (two-tier session documentation)
  - Agent architecture patterns
