---
id: RIS-RESOLUTION-028
title: License Lifecycle Management UX Design
type: enhancement
status: planned
priority: medium
risk_level: medium
created_at: 2025-12-02T14:55:00Z
completed_at: null
duration_minutes: null
session: SESSION-20251202-1430-provider-dashboard-npi-first-routing
lane: frontend, backend, worker
related_issues:
  - type: github_issue
    ref: "TBD"
    description: "Implement License Lifecycle Management UX (to be created)"
tags:
  - ux-design
  - license-management
  - status-workflow
  - compliance-tracking
  - user-intent-capture

problem:
  description: |
    Current license management lacks clear workflow for expired licenses:
    - No differentiation between "expired but renewing" vs "expired and archived"
    - No user intent capture for licenses expired > 3 months
    - No automated archival of old licenses (clutter in UI)
    - No visual hierarchy for license urgency
    - Unclear what happens to licenses after 12 months

  root_cause: |
    1. Simple binary status: active | expired (no intermediate states)
    2. No workflow for capturing user's renewal intent
    3. No automated status transitions based on expiration timeline
    4. No UI differentiation for archived vs active credentials
    5. No notification timeline for expiration milestones

  impact:
    - User confusion about expired license status
    - Dashboard clutter from old/inactive licenses
    - No data on which licenses are truly discontinued
    - Compliance ambiguity (is provider working to renew or not?)

solution:
  approach: |
    Implement comprehensive license lifecycle management:

    1. Expanded status workflow with 5 states
    2. Proactive intent capture at 3 months post-expiration
    3. Automated status updates via Celery background job
    4. Visual UI hierarchy (active â†’ expiring â†’ expired â†’ archived)
    5. Notification timeline with multi-channel alerts

  status_workflow:
    states:
      active:
        description: "Valid license, > 3 months before expiration"
        color: green
        icon: "âœ… CheckCircle"
        badge_text: "Valid until [date]"

      expiring_soon:
        description: "1-3 months before expiration"
        color: yellow
        icon: "âš ï¸ AlertTriangle"
        badge_text: "Expires in X days - Action Required"

      expired:
        description: "0-12 months after expiration"
        color: red
        icon: "ğŸ”´ XCircle"
        badge_text: "Expired X days ago - URGENT"

      not_renewing:
        description: "User indicated no renewal intent"
        color: orange
        icon: "ğŸš« Ban"
        badge_text: "Not pursuing renewal"

      archived:
        description: "> 12 months after expiration"
        color: gray
        icon: "ğŸ“¦ Archive"
        badge_text: "Archived [date]"
        hidden_by_default: true

    transitions:
      - from: active
        to: expiring_soon
        trigger: "90 days before expiration (automated)"

      - from: expiring_soon
        to: expired
        trigger: "Expiration date passes (automated)"

      - from: expired
        to: not_renewing
        trigger: "User answers 'No' to renewal intent modal"

      - from: expired
        to: archived
        trigger: "12 months after expiration (automated)"

      - from: not_renewing
        to: archived
        trigger: "9 months after intent captured (automated)"

  ux_components:
    renewal_intent_modal:
      description: "Modal popup at 3 months post-expiration"
      trigger: "90 days after expiration date"
      frequency: "Once, can be dismissed and re-accessed"
      content: |
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Your CA Medical License Expired 3 Months Ago      â”‚
        â”‚                                                    â”‚
        â”‚  License #: CA-MD-123456                           â”‚
        â”‚  Expired: 2024-09-15                               â”‚
        â”‚                                                    â”‚
        â”‚  Are you planning to renew this license?           â”‚
        â”‚                                                    â”‚
        â”‚  [ Yes, I'm Renewing ]  [ No, Not Renewing ]       â”‚
        â”‚                                                    â”‚
        â”‚  â„¹ï¸ What happens next:                             â”‚
        â”‚  â€¢ "Yes" â†’ Track renewal progress                  â”‚
        â”‚  â€¢ "No" â†’ Archive after 9 months                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      actions:
        yes_renewing:
          effect: "renewal_intent = 'renewing', status stays 'expired'"
          follow_up: "Show renewal progress tracker"

        no_not_renewing:
          effect: "status = 'not_renewing', start 9-month countdown"
          follow_up: "License hidden from active view, countdown to archive"

        ask_later:
          effect: "No status change, can re-trigger from license detail"
          follow_up: "Modal can be re-opened manually"

    dashboard_layout:
      section_a_active:
        visibility: always
        content: "Active licenses (green badges)"
        action_buttons: "Renew Now, View Details"

      section_b_urgent:
        visibility: conditional (if expired < 90 days)
        content: "Expired licenses needing attention (red banner)"
        action_buttons: "Start Renewal, Update Status"

      section_c_expiring:
        visibility: conditional (if licenses expiring < 90 days)
        content: "Licenses expiring soon (yellow banner)"
        action_buttons: "Renew Now, Snooze"

      section_d_archived:
        visibility: collapsed by default
        content: "Archived/inactive licenses (gray, faded)"
        toggle: "[ + Show Archived Licenses (N) ]"

    status_badge:
      component: StatusBadge
      props:
        - status: LicenseStatus
        - expirationDate: Date
        - daysUntilExpiration: number
      styling:
        active: "bg-green-50 border-green-200 text-green-700"
        expiring_soon: "bg-yellow-50 border-yellow-200 text-yellow-700"
        expired: "bg-red-50 border-red-200 text-red-700"
        not_renewing: "bg-orange-50 border-orange-200 text-orange-700"
        archived: "bg-gray-50 border-gray-200 text-gray-500"

  notification_timeline:
    - days_from_expiration: -90
      trigger: "First reminder"
      channels: [email]
      message: "License expires in 3 months"

    - days_from_expiration: -30
      trigger: "Urgent reminder"
      channels: [email, dashboard_banner]
      message: "License expires in 30 days - Action Required"

    - days_from_expiration: -7
      trigger: "Critical alert"
      channels: [email, sms, dashboard_modal]
      message: "License expires in 7 days - CRITICAL"

    - days_from_expiration: 0
      trigger: "Expiration day"
      channels: [email, dashboard_alert]
      message: "License expired today"

    - days_from_expiration: +30
      trigger: "First expired notice"
      channels: [email]
      message: "License expired 30 days ago"

    - days_from_expiration: +90
      trigger: "Intent capture"
      channels: [email, dashboard_modal]
      message: "Are you renewing? (Modal)"

    - days_from_expiration: +365
      trigger: "Auto-archive"
      channels: [email]
      message: "License archived"

  database_schema:
    table: licenses
    new_columns:
      - name: renewal_intent
        type: VARCHAR(50)
        nullable: true
        values: [null, 'renewing', 'not_renewing']
        description: "User's stated intention for renewal"

      - name: intent_captured_at
        type: TIMESTAMP
        nullable: true
        description: "When user answered the renewal intent modal"

      - name: archived_at
        type: TIMESTAMP
        nullable: true
        description: "When license was archived"

      - name: archive_reason
        type: TEXT
        nullable: true
        description: "Why license was archived"

    enum_updates:
      file: shared/domain/types.py
      class: LicenseStatus
      new_values:
        - EXPIRING_SOON = "expiring_soon"
        - NOT_RENEWING = "not_renewing"
        - ARCHIVED = "archived"

  backend_implementation:
    celery_task:
      file: apps/worker-tasks/src/tasks/license_status_updater.py
      function: update_license_statuses
      schedule: "Daily at 2:00 AM UTC"
      logic:
        - Mark as expiring_soon: 90 days before expiration
        - Mark as expired: Day after expiration
        - Mark as archived: 12 months after expiration

    api_endpoint:
      method: PUT
      path: /api/v1/licenses/{id}/renewal-intent
      body:
        renewal_intent: "'renewing' | 'not_renewing'"
      response:
        license: Updated license object
        message: "Renewal intent captured"

  implementation_checklist:
    database:
      - Create Alembic migration for new columns
      - Update LicenseStatus enum
      - Backfill existing expired licenses

    backend:
      - Create Celery task for automated status updates
      - Add Celery beat schedule (daily at 2 AM UTC)
      - Create renewal intent API endpoint
      - Add email notification service

    frontend:
      - Create RenewalIntentModal component
      - Create StatusBadge component
      - Create LicenseCard component with actions
      - Create LicenseFilter component (archive toggle)
      - Update dashboard layout with new sections
      - Add modal trigger logic (90 days post-expiration)

    testing:
      - Unit tests for status update logic
      - Integration tests for Celery task
      - Frontend tests for modal behavior
      - Email notification tests

design_decisions:
  decision_1:
    title: "Proactive Intent Capture at 3 Months"
    rationale: |
      Gives users time to renew (typical renewal: 30-90 days).
      Captures decision while license is still recent enough to remember.
    alternative_considered: "Wait until 12 months (rejected - too late)"
    trade_off: "May feel pushy, but prevents ambiguity"

  decision_2:
    title: "Separate 'Not Renewing' Status"
    rationale: |
      Differentiates active non-compliance from intentional discontinuation.
      Provides clearer data for analytics and compliance tracking.
    alternative_considered: "Immediate archive (rejected - too aggressive)"
    trade_off: "Extra status to manage, but clearer intent"

  decision_3:
    title: "Archived Licenses Hidden by Default"
    rationale: |
      Reduces dashboard clutter for active providers.
      Most users don't need to see old inactive licenses regularly.
    alternative_considered: "Always visible (rejected - too busy)"
    trade_off: "Users must explicitly toggle to view history"

  decision_4:
    title: "Modal vs Banner for Intent Capture"
    rationale: |
      Modal ensures user acknowledgment and decision.
      Cannot be passively ignored like banner notifications.
    alternative_considered: "Banner notification (rejected - easy to ignore)"
    trade_off: "More intrusive, but captures decision"

  decision_5:
    title: "12-Month Archive Threshold"
    rationale: |
      Balances compliance record-keeping with UI simplicity.
      Most renewals happen within 6 months, 12 months is generous buffer.
    alternative_considered: "24 months (rejected - too long)"
    trade_off: "May archive licenses user intends to renew late"

risks_and_mitigation:
  risk_1:
    risk: "User confusion with intent modal"
    impact: medium
    mitigation:
      - Allow "Ask me later" option
      - Provide clear explanation of consequences
      - Make modal re-accessible from license detail page

  risk_2:
    risk: "Premature auto-archive"
    impact: low
    mitigation:
      - Send email 30 days before archive
      - Allow manual status override
      - Archived licenses can be "unarchived"

  risk_3:
    risk: "Celery task failure"
    impact: high
    mitigation:
      - Add monitoring/alerting for task execution
      - Log all status changes with audit trail
      - Add manual "Refresh Status" button in UI

  risk_4:
    risk: "Migration impact on existing licenses"
    impact: medium
    mitigation:
      - Run status update script after migration
      - Test on staging database first
      - Provide rollback plan

outcomes:
  expected_benefits:
    - Clearer license status workflow for users
    - Reduced dashboard clutter from old licenses
    - Better compliance tracking data
    - Proactive user engagement for renewals

  success_metrics:
    - Percentage of users responding to intent modal > 80%
    - Archived licenses reducing dashboard size by 30%+
    - User satisfaction score increase for license management

lessons_learned:
  from_design_process:
    - User intent capture requires balance between proactive and intrusive
    - Visual hierarchy more important than quantity of information
    - Automated lifecycle management reduces manual work significantly

  reusable_patterns:
    - Status workflow state machine
    - Proactive intent capture via modals
    - Tiered visibility (active/archived toggle)
    - Multi-channel notification timeline

recommendations:
  immediate:
    - Create GitHub issue with full implementation plan
    - Get user feedback on modal wording
    - Create wireframes for new dashboard layout

  future:
    - Apply similar lifecycle pattern to DEA/CSR credentials
    - Consider similar intent capture for CME cycles
    - Build analytics dashboard for renewal trends

references:
  session_doc: sessions/20251201/SESSION-20251202-1430-provider-dashboard-npi-first-routing.md
  design_section: "Section 5: License Lifecycle Management UX Design"

  kb_articles:
    - docs/kb/ux/license-lifecycle-management.md (pending)
    - docs/kb/architecture/status-workflow-patterns.md (pending)
    - docs/kb/frontend/status-badge-design-system.md (pending)

  related_ris:
    - RIS-RESOLUTION-027 (provider dashboard routing fix)

next_steps:
  - Create database migration
  - Implement Celery task for status updates
  - Build frontend components
  - Write comprehensive tests
  - Create KB documentation

metadata:
  author: Claude Code
  reviewed_by: null
  approved_by: null
  archived: false
---
