---
id: RIS-TASK-GOV-043-SANDBOX-REJECTION-HANDLING
title: "Sandbox Rejection Handling System"
category: governance
priority: high
status: completed
created: 2025-11-28
completed: 2025-11-28
assignee: claire
tags: [governance, sandbox, rejection, bundle-4, v1.8.3]
classification: T1
risk_level: MEDIUM
capsule: v1.8.2
governed_by_capsule: v1.8.2
---

## Objective
Implement comprehensive rejection handling system with remediation workflows for the AI Sandbox Engine.

## Description
Created rejection reasons catalog, remediation workflows, and prevention guidance to handle validation failures systematically across all seven validation gates.

## Deliverables
- [x] 10 rejection categories
- [x] 40+ rejection codes with descriptions
- [x] Severity-based remediation workflows
- [x] Auto-fix capabilities for LOW severity
- [x] Rejection logging specification
- [x] Prevention best practices
- [x] Appeal process

## Rejection Categories
1. **Syntax Errors**: YAML, JSON, Markdown, Python, TypeScript, Shell
2. **FPG Violations**: Wrong directory, orphan location, extension mismatch
3. **Capsule Compliance**: Legacy references, wrong version, broken authority
4. **RIS/KB References**: Missing task/incident/session IDs, broken links
5. **Fingerprint Violations**: Invalid format, classification errors, tampering
6. **Drift Detection**: Semantic changes, structural violations, naming issues
7. **Secrets Leakage**: AWS credentials, private keys, passwords, URLs with auth
8. **Apply Gate Violations**: Target conflicts, permission denied, TAM blocks
9. **Classification Failures**: Unknown types, ambiguous content
10. **Validation Failures**: Timeouts, multiple gate failures, critical risk

## Rejection Severity
| Severity | Action | Auto-Retry |
|----------|--------|------------|
| CRITICAL (Secrets) | Immediate quarantine + security alert | No |
| HIGH (Capsule, Fingerprint, Apply) | Manual review required | No |
| MEDIUM (FPG, References, Drift) | Correction and re-validation | Yes (once) |
| LOW (Syntax, Classification) | Automatic correction possible | Yes (3x) |

## Remediation Workflows
1. **Automatic (LOW)**: Sandbox attempts auto-fix, re-validates
2. **Manual (MEDIUM/HIGH)**: User corrects, resubmits to .sandbox/incoming/
3. **Critical (CRITICAL)**: Immediate quarantine, security review, rotate credentials if exposed

## Testing
- [x] Rejection codes documented
- [x] Remediation workflows defined
- [x] Auto-fix capabilities specified
- [x] Logging format created

## Related Documents
- [governance/sandbox/sandbox_engine.md](../../governance/sandbox/sandbox_engine.md)
- [governance/sandbox/rejection_reasons.md](../../governance/sandbox/rejection_reasons.md)
- [governance/sandbox/validation_matrix.md](../../governance/sandbox/validation_matrix.md)

## Success Criteria
- [x] All rejection categories documented
- [x] Clear remediation path for each rejection type
- [x] Auto-fix capabilities for common issues
- [x] Security incident handling for secrets leakage

## Notes
Comprehensive rejection handling ensures that validation failures are handled systematically with appropriate remediation workflows and security incident response for critical issues.
