---
id: RIS-TASK-GOV-044-SANDBOX-ORCHESTRATOR-INTEGRATION
title: "Sandbox Orchestrator Integration"
category: governance
priority: high
status: completed
created: 2025-11-28
completed: 2025-11-28
assignee: claire
tags: [governance, sandbox, orchestrator, bundle-4, v1.8.3]
classification: T1
risk_level: MEDIUM
capsule: v1.8.2
governed_by_capsule: v1.8.2
---

## Objective
Integrate the AI Sandbox Engine v1.8.3 with all orchestrator commands to enforce sandbox-first file handling.

## Description
Updated all orchestrator commands (work.md, session-start.md, session-end.md, checkup.md, checkup-deep.md) to integrate sandbox initialization, validation, and apply hooks.

## Deliverables
- [x] Updated `.claude/work.md` with Bundle 4 sandbox loading
- [x] Updated `.claude/commands/session-start.md` with sandbox initialization
- [x] Updated `.claude/commands/session-end.md` with sandbox final sweep
- [x] Updated `.claude/commands/checkup.md` with sandbox status checks
- [x] Updated `.claude/commands/checkup-deep.md` with sandbox deep sweep

## Integration Points

### work.md (Phase 1 - Governance Boot)
- Load Bundle 4 Sandbox engines
- Verify .sandbox/ structure
- Clear stale incoming files
- Initialize sandbox manifest

### work.md (Phase 3 - Hook Registration)
- Sandbox Hook: Route all AI files through .sandbox/incoming/
- Sandbox Validation Hook: Seven-gate validation
- Sandbox Apply Hook: TAM-governed application

### session-start.md
- Load Bundle 4 engines during governance context loading
- Initialize sandbox during pre-session sweep
- Register sandbox hooks
- Clear stale incoming files from previous sessions

### session-end.md
- Include sandbox summary in session report
- Run sandbox final sweep (no files in incoming/, process validated/)
- Block push if sandbox has pending files
- Log sandbox metrics to session summary

### checkup.md
- Load Bundle 4 engines
- Report sandbox queue status (incoming, validated, rejected)
- Include sandbox status in output

### checkup-deep.md
- Load Bundle 4 engines
- Run sandbox deep sweep (validate all, analyze patterns)
- Report comprehensive sandbox metrics

## Testing
- [x] All commands updated with Bundle 4 references
- [x] Sandbox initialization in session-start
- [x] Sandbox final sweep in session-end
- [x] Sandbox status in checkup commands
- [x] UI output includes sandbox metrics

## Related Documents
- [.claude/work.md](../../.claude/work.md)
- [.claude/commands/session-start.md](../../.claude/commands/session-start.md)
- [.claude/commands/session-end.md](../../.claude/commands/session-end.md)
- [.claude/commands/checkup.md](../../.claude/commands/checkup.md)
- [.claude/commands/checkup-deep.md](../../.claude/commands/checkup-deep.md)
- [governance/sandbox/sandbox_engine.md](../../governance/sandbox/sandbox_engine.md)

## Success Criteria
- [x] All orchestrator commands reference Bundle 4
- [x] Sandbox initialization in session-start
- [x] Sandbox finalization in session-end
- [x] Sandbox monitoring in checkup commands
- [x] No direct file writes allowed (enforced by hooks)

## Notes
Orchestrator integration ensures that the sandbox is automatically initialized, monitored, and finalized across all governed sessions, preventing direct writes and enforcing validation for all AI-generated files.
